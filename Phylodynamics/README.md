# From the dated phylogenetic trees to the visualisation of exchange events
<p>Metadata can be shared on demand. They consist, for each GISAID identifier, of the date, the pango lineage, the continent, the country and, in the case of French samples, the French administrative region.</p><br>
 <h3>Check if a dataset positively correlates with epidemiological data</h3>
 <p>Before performing phylodynamics analysis, it is essential to confirm that a subsample is posively correlated with epidemiological data. In this work, we used the number of SARS-CoV-2-related deaths for each country (or French region). Epidemiological data for each country or French regions are provided in the Data/ repository. To perform the correlation, we developped R scripts, named <i><b>dataset_correlation_World.R</b></i>, <i><b>dataset_correlation_Europe.R</b></i> and <i><b>dataset_correlation_France.R</b></i> that first compare the cumulative number of deaths and sequences at the end of the time period studied, then directly compare per week the number of deaths and sequences included.
</p>
 <br>
 <h3>Count the number of distinct sequences across the replicates</h3>
 <p>Assuming we focus on one time period and one geographic scale (for example, worldwide scale, first half of 2020), we developed a short R script, named <i><b>count_distinct_sequences.R</b></i> that count the number of unique identifiers across the subsamples. A sequence that appeared multiple times across the subsamples is counted once.</p>
  <br>
   <h3>Compare the genetic distances between locations</h3>
 <p>Although optional, we developped a R script, named <i><b>genetic_distances.R</b></i>, to check whether some locations were associated with higher or lower genetic distances (based on SARS-CoV-2 sequences) across the phylogenetic trees. Since the procedure is time-consuming, we recommand to perform the analysis only on a few subsamples. As previously reported in some papers, we observed that all locations have almost systematically similar genetic distances. The script includes the analysis for each geographic scale (world, Europe and French regions).</p>
  <br>
     <h3>Phylodynamics analysis</h3>
 <p>The phylodynamics analyses are separated into different geographic scales and time periods: <i><b>calcul_transmission_world_w1.R</b></i>, <i><b>calcul_transmission_world_w2.R</b></i>, <i><b>calcul_transmission_europe_w1.R</b></i>, <i><b>calcul_transmission_europe_w2.R</b></i>, <i><b>calcul_transmission_france_w1.R</b></i> and <i><b>calcul_transmission_france_w2.R</b></i>. As a first step, all exchange events are calculated across the subsamples (for a given time period and geographic scale). To calculate exchange events, we first determine ancestral state at nodes using the ace function of the R ape package. We recommand the use of SYM or ER models, since the ARD model leads to similar results but is very time-consuming. From the ancestral reconstruction, we checked for each node of the phylogenetic tree whether children nodes corresponded to the same geographic region as the current node. If they correspond to different geographic locations, we then assumed the exchange from the parent node-state to the given child node-state (exchange event). The midpoint of the parent-child branch was chosen as the date of the exchange in all cases.</p>
 <p>Once exchange events are calculated, they are averaged across the subsamples. We then realize some plots to study the variations of exchanges across the subsamples, the number of inter-territory exchange events for each location, or even the date of exchanges originating from a specific location.</p>
